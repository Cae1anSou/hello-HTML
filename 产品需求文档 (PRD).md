产品需求文档 (PRD) - V1.0: 自适应动态 AI 系统

1. 背景与目标 (Background & Goals)

- 背景: 我们打算投 ACM CHI 这个会议，目前打算做 AI 教学方向。为提升编程初学者的在线学习体验，我们旨在构建一个能实时感知学习者状态并提供个性化反馈的 AI 教学系统。
- 目标用户 (Persona): 计算机专业大一/大二学生，或对 Web 前端（HTML/CSS/JS）感兴趣的编程初学者。
- 要解决的核心问题: 解决静态 AI 教程无法感知学习者挫败感、认知负荷和知识盲区，导致学习效率低下和体验不佳的问题。
- 项目目标/成功指标:
  - 科研目标: 证明动态用户建模在提升学习效果（前后测）、降低认知负荷（NASA-TLX）、提升用户体验（感知个性化、自我效能感、信任度）上显著优于静态 AI。
  - 产品目标: 构建一个稳定、流畅的学习系统，能成功运行 A/B 对照实验，并完整采集到所需数据。

2. 功能详述 (Feature Specifications)
   Epic 1: 知识图谱导航页 (对应第一个网页)

- 用户故事:
  - “作为一个学生，我希望能看到所有知识点的学习路径，以便我对整个课程有宏观的认识。”
  - “作为一个学生，我可以点击某个知识点节点，进入相应的学习页面。”
  - “作为一个有基础的学生，我可以点击一个靠后的节点并通过一个快速测试，来一次性解锁所有前置知识点。”
- 需求细则:
  - 【P0 - 必须有】前端需要渲染一个知识图谱，展示 HTML, CSS, JS 的知识点结构。
  - 【P0】图谱中的节点是可点击的。
  - 【P1 - 可选/V2】实现“测试解锁”功能。
    Epic 2: 核心学习界面 (对应第二个网页)
- 用户故事:
  - “作为一个学生，我希望可以按照我的兴趣来选择我想学习的部分进行学习。我希望我可以自由选择我想学的部分，然后 AI 也能知道我选了哪个”
  - “作为一个学生，当我感到困惑时，我可以向 AI 助教提问，它会给我易于理解的回答。”
  - “作为一个学生，当我因为连续犯错而感到沮丧时，我希望 AI 助教能主动给我一些鼓励，而不是冷冰冰地指出错误。”
- 需求细则:
  - 【P0】界面布局为三栏：内嵌示例网页、AI 对话框、知识展示框。
  - 【P0】实现示例网页 DOM 元素抓取功能，点击元素能联动知识展示框和 AI。
  - 【P0】AI 对话框可以接收用户输入，并调用后端 LLM API 返回结果。
  - 【P0】自适应反馈逻辑: - 规则 1 - 挫败感安抚: 当后端“控制器”判断用户状态为 Frustrated 时 (规则：2 分钟内错误率 > 75% 且 提交间隔 < 10 秒)，AI 的下一次回答必须包含鼓励性、安抚性语气。 - 规则 2 - 困惑时细化讲解: 当后端判断用户为 Confused 时 (规则：单步耗时 > 3 倍平均耗时 且 操作错误)，AI 的下一次回答必须将知识点拆解得更细，或提供更简单的例子。 - 。。。。
    Epic 3: 编码测试界面 (对应第三个网页)
- 用户故事:
  - “作为一个学生，我可以在一个代码编辑器里写代码来完成测试任务。”
  - “作为一个学生，我可以实时看到我写的代码所呈现的网页效果。”
  - “作为一个学生，在测试中遇到困难时，我也可以向 AI 求助，它会给我提示而不是直接给答案。”
- 需求细则:
  - 【P0】界面包含代码编辑器、效果预览窗口和 AI 对话框。
  - 【P0】编辑器需要支持 HTML/CSS/JS 的语法高亮。
  - 【P0】编辑器需要能够根据预设的检查点检测用户所写的代码是否满足任务要求。
  - 【P0】AI 助教在测试界面的功能与学习界面基本一致，同样具备自适应能力。
    Epic 4: 后台与数据系统 (非功能性需求)
- 需求细则:
  - 【P0】学习者行为追踪: 系统必须能在前端实时捕获用户的代码修改、运行、提交、光标移动等学习痕迹，并按照 ProgSnap2 标准格式化后发送给后端。
  - 【P0】学习者状态建模:
    - 后端必须实现 BKT 模型，根据学生的答题历史，实时更新其对每个知识点的掌握概率 P(Ln)。
    - 后端必须实现一个基于规则的启发式引擎，根据行为数据推断学习者的情感与行为状态（如 Frustrated, Confused 等）。
    - 所有这些状态信息需要被整合成一个 JSON 格式的“学习者状态向量”。
  - 【P0】动态 Prompt 工程: 后端在调用 LLM API 前，必须根据“学习者状态向量”动态生成 Prompt，以控制 LLM 的输出。
  - 【P0】实验分组: 系统需要支持 A/B 测试，能将用户随机分为“实验组”（有动态模型）和“对照组”（无动态模型），并记录用户分组信息。

1. V1 版本范围 (Scope for V1.0)

- 包含功能 (In Scope):
  - 完成核心学习界面和编码测试界面的所有 P0 需求。
  - 至少完整实现“挫败感”和“困惑”两条自适应规则的闭环。
  - 完整的数据采集、BKT 建模和动态 Prompt 功能。
  - 完成前后测问卷和所有用户体验量表的线上部署和数据回收。
- 暂不包含 (Out of Scope for V1.0):
  - 知识图谱的“测试解锁”功能 (Epic 1 的 P1 需求)。
  - 除“挫败感”和“困惑”外的其他复杂情感建模。
    产品需求文档 (PRD) - V1.0: 自适应动态 AI 系统

1. 背景与目标 (Background & Goals)

- 背景: 我们打算投 ACM CHI 这个会议，目前打算做 AI 教学方向。为提升编程初学者的在线学习体验，我们旨在构建一个能实时感知学习者状态并提供个性化反馈的 AI 教学系统。
- 目标用户 (Persona): 计算机专业大一/大二学生，或对 Web 前端（HTML/CSS/JS）感兴趣的编程初学者。
- 要解决的核心问题: 解决静态 AI 教程无法感知学习者挫败感、认知负荷和知识盲区，导致学习效率低下和体验不佳的问题。
- 项目目标/成功指标:
  - 科研目标: 证明动态用户建模在提升学习效果（前后测）、降低认知负荷（NASA-TLX）、提升用户体验（感知个性化、自我效能感、信任度）上显著优于静态 AI。
  - 产品目标: 构建一个稳定、流畅的学习系统，能成功运行 A/B 对照实验，并完整采集到所需数据。

2. 功能详述 (Feature Specifications)
   Epic 1: 知识图谱导航页 (对应第一个网页)

- 用户故事:
  - “作为一个学生，我希望能看到所有知识点的学习路径，以便我对整个课程有宏观的认识。”
  - “作为一个学生，我可以点击某个知识点节点，进入相应的学习页面。”
  - “作为一个有基础的学生，我可以点击一个靠后的节点并通过一个快速测试，来一次性解锁所有前置知识点。”
- 需求细则:
  - 【P0 - 必须有】前端需要渲染一个知识图谱，展示 HTML, CSS, JS 的知识点结构。
  - 【P0】图谱中的节点是可点击的。
  - 【P1 - 可选/V2】实现“测试解锁”功能。
    Epic 2: 核心学习界面 (对应第二个网页)
- 用户故事:
  - “作为一个学生，我希望可以按照我的兴趣来选择我想学习的部分进行学习。我希望我可以自由选择我想学的部分，然后 AI 也能知道我选了哪个”
  - “作为一个学生，当我感到困惑时，我可以向 AI 助教提问，它会给我易于理解的回答。”
  - “作为一个学生，当我因为连续犯错而感到沮丧时，我希望 AI 助教能主动给我一些鼓励，而不是冷冰冰地指出错误。”
- 需求细则:
  - 【P0】界面布局为三栏：内嵌示例网页、AI 对话框、知识展示框。
  - 【P0】实现示例网页 DOM 元素抓取功能，点击元素能联动知识展示框和 AI。
  - 【P0】AI 对话框可以接收用户输入，并调用后端 LLM API 返回结果。
  - 【P0】自适应反馈逻辑: - 规则 1 - 挫败感安抚: 当后端“控制器”判断用户状态为 Frustrated 时 (规则：2 分钟内错误率 > 75% 且 提交间隔 < 10 秒)，AI 的下一次回答必须包含鼓励性、安抚性语气。 - 规则 2 - 困惑时细化讲解: 当后端判断用户为 Confused 时 (规则：单步耗时 > 3 倍平均耗时 且 操作错误)，AI 的下一次回答必须将知识点拆解得更细，或提供更简单的例子。 - 。。。。
    Epic 3: 编码测试界面 (对应第三个网页)
- 用户故事:
  - “作为一个学生，我可以在一个代码编辑器里写代码来完成测试任务。”
  - “作为一个学生，我可以实时看到我写的代码所呈现的网页效果。”
  - “作为一个学生，在测试中遇到困难时，我也可以向 AI 求助，它会给我提示而不是直接给答案。”
- 需求细则:
  - 【P0】界面包含代码编辑器、效果预览窗口和 AI 对话框。
  - 【P0】编辑器需要支持 HTML/CSS/JS 的语法高亮。
  - 【P0】编辑器需要能够根据预设的检查点检测用户所写的代码是否满足任务要求。
  - 【P0】AI 助教在测试界面的功能与学习界面基本一致，同样具备自适应能力。
    Epic 4: 后台与数据系统 (非功能性需求)
- 需求细则:
  - 【P0】学习者行为追踪: 系统必须能在前端实时捕获用户的代码修改、运行、提交、光标移动等学习痕迹，并按照 ProgSnap2 标准格式化后发送给后端。
  - 【P0】学习者状态建模:
    - 后端必须实现 BKT 模型，根据学生的答题历史，实时更新其对每个知识点的掌握概率 P(Ln)。
    - 后端必须实现一个基于规则的启发式引擎，根据行为数据推断学习者的情感与行为状态（如 Frustrated, Confused 等）。
    - 所有这些状态信息需要被整合成一个 JSON 格式的“学习者状态向量”。
  - 【P0】动态 Prompt 工程: 后端在调用 LLM API 前，必须根据“学习者状态向量”动态生成 Prompt，以控制 LLM 的输出。
  - 【P0】实验分组: 系统需要支持 A/B 测试，能将用户随机分为“实验组”（有动态模型）和“对照组”（无动态模型），并记录用户分组信息。

1. V1 版本范围 (Scope for V1.0)

- 包含功能 (In Scope):
  - 完成核心学习界面和编码测试界面的所有 P0 需求。
  - 至少完整实现“挫败感”和“困惑”两条自适应规则的闭环。
  - 完整的数据采集、BKT 建模和动态 Prompt 功能。
  - 完成前后测问卷和所有用户体验量表的线上部署和数据回收。
- 暂不包含 (Out of Scope for V1.0):
  - 知识图谱的“测试解锁”功能 (Epic 1 的 P1 需求)。
  - 除“挫败感”和“困惑”外的其他复杂情感建模。
